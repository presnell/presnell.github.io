<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.4.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Brett Presnell">

  
  
  
    
  
  <meta name="description" content="How to avoid reinstalling packages everytime you teach with R.">

  
  <link rel="alternate" hreflang="en-us" href="https://presnell.github.io/post/classroomr/">

  


  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.278b1f54b80222f4eeaf53cb606416ce.css">

  

  
  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://presnell.github.io/post/classroomr/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Brett Presnell">
  <meta property="og:url" content="https://presnell.github.io/post/classroomr/">
  <meta property="og:title" content="Setting R&#39;s Library Path on UF Classroom PCs | Brett Presnell">
  <meta property="og:description" content="How to avoid reinstalling packages everytime you teach with R."><meta property="og:image" content="https://presnell.github.io/img/icon-192.png">
  <meta property="twitter:image" content="https://presnell.github.io/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-08-25T20:53:56-04:00">
    
    <meta property="article:modified_time" content="2020-02-13T12:25:56-05:00">
  

  


  





  <title>Setting R&#39;s Library Path on UF Classroom PCs | Brett Presnell</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Brett Presnell</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/teaching/"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Setting R&#39;s Library Path on UF Classroom PCs</h1>

  
  <p class="page-subtitle">And Maybe on Your Office PC Too</p>
  

  
    



<meta content="2019-08-25 20:53:56 -0400 EDT" itemprop="datePublished">
<meta content="2020-02-13 12:25:56 -0500 EST" itemprop="dateModified">

<div class="article-metadata">

  
  
  
  
  <div>
    



  <span itemprop="author name" itemtype="http://schema.org/Person"><a href="/authors/admin/">Brett Presnell</a></span>

  </div>
  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    <time>Feb 13, 2020</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    5 min read
  </span>
  

  
  
  

  
  

  
    

  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      
<h2 id="headline-1">
What Is This About?
</h2>
<p>
After a very long hiatus from needing to run R in the classrooms, I am
back at it.  The classroom (Windows 10) PCs at UF are refreshed every
night and all local files created by users are wiped.  By default, R
packages installed by users are placed in <code class="verbatim">C:/Program
Files/R/R-3.5.2/library</code>,<sup class="footnote-reference"><a id="footnote-reference-1" href="#footnote-1">1</a></sup> and like everything else that users
create, they are wiped every night. Thus, if you accept the default
behavior, you have to resintall any packages you need every time you
need them.<sup class="footnote-reference"><a id="footnote-reference-2" href="#footnote-2">2</a></sup> This has been the source of some frustration for me
and at least one of my colleagues, so I decided to do something about
it.  This post describes my current (partial) solution, which I think
should also be useful for folks running R or RStudio on a desktop PC
in their office (in my department at UF anyway).  It&#39;s nothing fancy,
and if someone has a better solution I would be happy to hear about
it.
</p>
<h2 id="headline-2">
My Solution
</h2>
<p>
Download <a href="files/.Rprofile">this file</a> and save it under the name <code class="verbatim">.Rprofile</code> in your home
directory on the departmental file server (so <code class="verbatim">~/.Rprofile</code> in linux
and <code class="verbatim">H:/.Rprofile</code> in Windows), or use a text editor to create the
file yourself with with the following contents:
</p>
<div class="src src-r">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">if </span>(<span style="color:#a6e22e">grepl</span>(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Windows&#34;</span>, <span style="color:#a6e22e">Sys.info</span>()[<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">sysname&#34;</span>])) {
    my.lib.path <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">file.path</span>(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">H:&#34;</span>, <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">R&#34;</span>, <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">win-library&#34;</span>,
                             <span style="color:#a6e22e">paste</span>(R.version<span style="color:#f92672">$</span>major,
                                   <span style="color:#a6e22e">sub</span>(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">\\..*$&#34;</span>, <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">&#34;</span>, R.version<span style="color:#f92672">$</span>minor),
                                   sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">.&#34;</span>))
    <span style="color:#a6e22e">if </span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">dir.exists</span>(my.lib.path)) <span style="color:#a6e22e">dir.create</span>(my.lib.path, recursive <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
    <span style="color:#a6e22e">.libPaths</span>(my.lib.path)
    <span style="color:#a6e22e">rm</span>(my.lib.path)
}</code></pre></div>
</div>
<p>
Now, whenever you start R in the classroom, run the command
</p>
<div class="src src-r">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">source</span>(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">H:/.Rprofile&#34;</span>)</code></pre></div>
</div>
<p>
This first checks that you are running R in Windows. If so, then it
checks for the existence of the directory <code class="verbatim">H:/R/win-library/X.Y</code>,
where <code class="verbatim">X</code> is the major version number and <code class="verbatim">Y</code> is the minor version of
the current R process, and it creates this directory if it doesn&#39;t
already exist.  It then adds this directory to the front of R&#39;s
library path so that (1) R will look for packages there before trying
the system packages, and (2) R will install any new packages into this
directory rather than the system directory.
</p>
<p>
If anything about that is not ok with you, then you will need to
modify <code class="verbatim">.Rprofile</code> to suit your specific needs.  If you already have a
directory of installed R packages, you can either move/rename it to
match this scheme, or you can modify the script to match, assuming
that your directory is on your <code class="verbatim">H:</code> drive.
</p>
<h3 id="headline-3">
If You Run R in Windows in Your Office 
</h3>
<p>
If you place a copy of this <code class="verbatim">.Rprofile</code> file in whatever directory is
returned by the R command <code class="verbatim">path.expand(&#39;~&#39;)</code> (probably
<code class="verbatim">C:/Users/&lt;yourusername&gt;/Documents</code>), then R will run it automatically
upon startup (on your office PC) and any libraries you install in your
office will be saved to your <code class="verbatim">H:</code> drive.  Also, as long as your office
PC and the classroom PCs are running the same version of R, they will
share the same set of user-installed R packages.
</p>
<h2 id="headline-4">
Further Background and Explanation
</h2>
<p>
You can skip this if you like â€¦
</p>
<p>
When I login to a classroom machine, my home directory from the
departmental (virtual) file server is mounted as the <code class="verbatim">H:</code> drive in
Windows.  So, to sidestep the problem of repeatedly installing
packages, I initially created the folder <code class="verbatim">R/win-library/3.5</code><sup class="footnote-reference"><a id="footnote-reference-3" href="#footnote-3">3</a></sup> in my
home directory on the file server, and in the classroom, I just ran
the R command <code class="verbatim">.libPaths(&#34;H:/R/win-library/3.5&#34;)</code> immediately after
starting R (or RStudio).  With this, any libraries I install are saved
on the departmental file server and they are found again the next time
I teach (once I have run that command).
</p>
<p>
Of course this is still pretty annoying and I wanted to arrange things
so that it would be done automatically by an <code class="verbatim">.Rprofile</code> startup file.
This works if the file is placed in <code class="verbatim">C:/Users/myusername/Documents</code>,
which the R command <code class="verbatim">path.expand(&#39;~&#39;)</code> returns as be the default user
home on our classroom Windows PCs, but of course that file would also
get wiped every night, so placing the file there doesn&#39;t help.
</p>
<p>
Nevertheless, to accomodate differing/changing versions of R and to
automate the process as much as possible, I decided to create a
<code class="verbatim">.Rprofile</code> that checks if I am running Windows and if so, sets my R
library path to <code class="verbatim">.libPaths(&#34;H:/R/win-library/X.Y&#34;)</code>.  The <code class="verbatim">X.Y</code> is
replaced by whatever &#34;major.minor&#34; version of R is running (currently
3.5) and the directory is created if it doesn&#39;t already exist.
Because this is done only if I am running Windows, it has no effect on
my usual, completely satisfactory R environment in Linux.
</p>
<p>
The contents of my current <code class="verbatim">.Rprofile</code> file are given in the previous
section.  If you already have a non-empty <code class="verbatim">.Rprofile</code>, you could add
this to it, and of course you could also create different versions for
different classes and put them in the appropriate places if that
tickles your fancy.  In the classroom I still have to run
</p>
<div class="src src-r">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">source</span>(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">H:/.Rprofile&#34;</span>)</code></pre></div>
</div>
<p>
after starting R, but I guess I&#39;m going to have to live with that.
</p>
<h2 id="headline-5">
Footnotes
</h2>
<p>
<sup class="footnote-reference"><a id="footnote-reference-1" href="#footnote-1">1</a></sup>Coming from the UNIX/Linux world this already seems a bit
crazy.  Why am I running R as root here?  BTW, you should mentally
replace &#34;3.5.2&#34; with whatever version of R is currently installed on
the PC, and Windows/DOS users may be more comfortable replacing the
&#34;/&#34; path separator by &#34;\&#34;.
</p>
<p>
<sup class="footnote-reference"><a id="footnote-reference-2" href="#footnote-2">2</a></sup>The classroom IT folks suggest using a USB thumbdrive as a
workaround.  <code class="verbatim">insert sad face here</code>
</p>
<p>
<sup class="footnote-reference"><a id="footnote-reference-3" href="#footnote-3">3</a></sup>From what I saw on the classroom PCs, it appears that
<code class="verbatim">win-library</code> is the R default name for the user&#39;s R libraries in
Windows, so I decided to stick with that. (On Linux it&#39;s something
like <code class="verbatim">x86_64-pc-linux-gnu-library</code>.)
</p>
<div class="footnotes">
<hr class="footnotes-separatator">
<div class="footnote-definitions">
</div>
</div>

    </div>

    


    



    
      








  
  
    
  
  





  
  
  
    
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu199db3fffa10f67fb3ca1ac1160969c5_45916_250x250_fill_q90_lanczos_center.jpg" itemprop="image" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="https://presnell.github.io/">Brett Presnell</a></h5>
      <h6 class="card-subtitle">Associate Professor of Statistics</h6>
      <p class="card-text" itemprop="description">My research interests include nonparametric and computationally intensive statistics, model misspecification, statistical computing, and the analysis of directional data.</p>
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://scholar.google.com/citations?user=cUQ7YCMAAAAJ" target="_blank" rel="noopener">
              <i class="ai ai-google-scholar"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://github.com/presnell" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
          
          
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="/files/vita.pdf" >
              <i class="ai ai-cv"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
    

    

    


  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
      

      
      
    

    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.16bbb3750feb7244c9bc409a5a4fe678.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
